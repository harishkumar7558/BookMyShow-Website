"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9411],{59411:function(e,t,n){n.d(t,{I:function(){return R},Q:function(){return E}});var r=n(70865),a=n(92228),i=n(52322),o=n(14865),c=n(2784),u=n(73857),s=n(19596),l=n(75217),d=n(91842),f=n(35355),g=n(85285),m=n(9263),v=n(72471),T=n(11869),_=n(19471),h=n(42886);function U(){var e=(0,a.Z)(["\n    height: ",";\n    animation: reaction-summary-fade-in ","ms ease-in;\n\n    @keyframes reaction-summary-fade-in {\n        from {\n            opacity: 0;\n        }\n\n        to {\n            opacity: 1;\n        }\n    }\n"]);return U=function(){return e},e}function b(){var e=(0,a.Z)(["\n    width: ",";\n    margin-left: ",";\n    vertical-align: top;\n    margin-right: ",";\n    height: ",";\n"]);return b=function(){return e},e}function p(){var e=(0,a.Z)(["\n    margin-left: -",";\n"]);return p=function(){return e},e}var S=function(e){var t=e.associatedConstId,n=e.entityType,r=e.initialAggregateData,a=e.initialUserData,o=e.className,s=e.testIdSuffix,l=(0,u.Z)(),d=(0,f.nu)();(0,h.Z)({associatedConstId:t,entityType:n,initialAggregateData:r,initialUserData:a});var U=(0,m.i9)(t,g.ly.EMOJI),b=(0,m.i9)(t,g.ly.INTERESTING),p=(0,T.VB)(t),S=(0,m.AE)(t,d),R=c.useMemo((function(){return(0,_.lu)(b,p,n,l)}),[b,p,n,l]),E=c.useMemo((function(){return(0,_.Nf)(U,p,n,l)}),[U,p,n,l]);return S===v.e.FETCHING?(0,i.jsx)(O,{className:o,"data-testid":g.z7.REACTION_SUMMARY_LOADING_SPACER}):S!==v.e.ERROR&&U&&b?(0,i.jsx)(I,{likeAriaLabel:R.accessibilityLabel,likeCount:R.label,likeActive:R.active,reactionAriaLabel:E.accessibilityLabel,reactionCount:E.label,reactionActive:E.active,primaryReaction:E.primaryReaction,secondaryReaction:E.secondaryReaction,className:o,"data-testid":"".concat(g.z7.REACTION_SUMMARY).concat(s)}):null},R=function(e){return o.isBrowser?(0,i.jsx)(S,(0,r.Z)({},e)):(0,i.jsx)(O,{className:e.className,"data-testid":g.z7.REACTION_SUMMARY_LOADING_SPACER})},E=function(e){return(0,i.jsx)(A,{children:(0,i.jsx)(R,(0,r.Z)({},e))})},I=(0,s.styled)(l.A)(U(),d.spacing.l,300),O=s.styled.div(b(),d.spacing.m,d.spacing.xxs,d.spacing.xs,d.spacing.l),A=s.styled.div(p(),d.spacing.xxs)},85285:function(e,t,n){n.d(t,{$N:function(){return v},Ev:function(){return S},G5:function(){return p},N2:function(){return U},PO:function(){return m},bq:function(){return _},cC:function(){return h},kL:function(){return T},ly:function(){return g},z7:function(){return b}});var r,a,i,o,c=n(47842),u=n(70865),s=n(16630),l=n.n(s),d=n(76510),f=n(49442),g={INTERESTING:"INTERESTING",EMOJI:"EMOJI"},m={THUMBS_UP:"interesting.thumbsup",THUMBS_DOWN:"interesting.thumbsdown",EXCITED:"emoji.excited",LIGHTBULB:"emoji.lightbulb",CLAP:"emoji.clappinghands",HEART:"emoji.heart",LAUGH:"emoji.laugh"},v=new(l())([m.THUMBS_DOWN,m.THUMBS_UP]),T=(r={},(0,c.Z)(r,m.THUMBS_DOWN,m.THUMBS_UP),(0,c.Z)(r,m.THUMBS_UP,m.THUMBS_DOWN),r),_=(a={},(0,c.Z)(a,m.EXCITED,f.o5.STAR_EYES),(0,c.Z)(a,m.LIGHTBULB,f.o5.LIGHT_BULB),(0,c.Z)(a,m.CLAP,f.o5.CLAP),(0,c.Z)(a,m.HEART,f.o5.HEART),(0,c.Z)(a,m.LAUGH,f.o5.LAUGH),a),h=(0,u.Z)((i={},(0,c.Z)(i,m.THUMBS_DOWN,"thumbs-down"),(0,c.Z)(i,m.THUMBS_UP,"thumbs-up"),i),_),U=(0,d.vU)({SELECTOR_EMOJI_DROPDOWN_BUTTON:{defaultMessage:"Open reactions menu",id:"feature_reactions_selector_open_menu"}}),b={REACTION_SELECTOR_SPACER:"reaction-selector-wrapper-spacing",REACTION_SELECTOR:"reaction-selector",REACTION_SUMMARY:"reaction-summary",REACTION_SUMMARY_LOADING_SPACER:"reaction-summary-loading-spacer"},p={CHIP:"chip",BUTTON:"button",MENU:"menu",ACTIVE:"active",INACTIVE:"inactive"},S={REACTION_AFFIX:"rx",SIGNED_OUT_PREFIX:"tmp",REACTION_UPDATE_STATE:{ADD:"add",DELETE:"del"},REACTION_MENU_OPEN:"react-open",REACTION_IDS_PREFIX:(o={},(0,c.Z)(o,m.THUMBS_UP,"tmup"),(0,c.Z)(o,m.THUMBS_DOWN,"tmdn"),(0,c.Z)(o,m.EXCITED,"stry"),(0,c.Z)(o,m.LIGHTBULB,"litblb"),(0,c.Z)(o,m.CLAP,"clp"),(0,c.Z)(o,m.HEART,"hrt"),(0,c.Z)(o,m.LAUGH,"lagh"),o)}},19471:function(e,t,n){n.d(t,{BO:function(){return D},Fh:function(){return H},Nc:function(){return P},Nf:function(){return B},lu:function(){return y},pY:function(){return w},pp:function(){return L},uF:function(){return Z}});var r=n(47842),a=n(70865),i=n(96670),o=n(66383),c=n(16630),u=n.n(c),s=n(58036),l=n(85285),d=n(72471),f=n(87993),g="Unexpected Reaction Label Information",m="".concat("feature_reactions","_summary"),v="user_only",T="user_and_others",_="others",h="none",U="emoji",b="emoji_one",p="emoji_two",S="likes",R=function(e,t){return t.formatNumber(e,{notation:"compact",compactDisplay:"short"})},E=function(e,t){return t.formatMessage({id:"feature_reactions_selector_like_label",defaultMessage:"{likeCount, plural, =0 {Like} =1 {Like with 1 person} other {Like with {likeCount} people}}"},{likeCount:e})},I=function(e,t){return t.formatMessage({id:"feature_reactions_selector_like_title",defaultMessage:"{active, select, true {Select to remove like} other {Select to like}}"},{active:e})},O=function(e){return e.formatMessage({id:"feature_reactions_selector_dislike_label",defaultMessage:"Dislike"})},A=function(e,t){return t.formatMessage({id:"feature_reactions_selector_dislike_title",defaultMessage:"{active, select, true {Select to remove dislike} other {Select to dislike}}"},{active:e})},C=function(e,t,n){return n.formatMessage({id:"feature_reactions_selector_reaction_label",defaultMessage:"{reactionCount, plural, =0 {React {reactionName}} =1 {React {reactionName} with 1 person} other {React {reactionName} with {reactionCount} people}}"},{reactionName:e,reactionCount:t})},N=function(e,t,n,r){var a=h,i=e;return t?a=--i?T:v:i&&(a=_),r.formatMessage({id:"".concat(m,"_").concat(n,"_").concat(S,"_").concat(a),defaultMessage:g},{likeCount:i})},M=function(e,t,n,r,a,i){var o=h,c=U,u=e;return e&&(t?(u--,i&&u--,o=u?T:v):o=_,c=i?p:b),r.formatMessage({id:"".concat(m,"_").concat(n,"_").concat(c,"_").concat(o),defaultMessage:g},{reactionCount:u,primaryReaction:a,secondaryReaction:i})},y=function(e,t,n,r){if(!e||!t)return{label:"0",active:!1,accessibilityLabel:N(0,!1,n,r)};var a,i=e.reactions[l.PO.THUMBS_UP],o=t.includes(l.PO.THUMBS_UP),c=null!==(a=null===i||void 0===i?void 0:i.count)&&void 0!==a?a:0;return{accessibilityLabel:N(c,o,n,r),label:R(c,r),active:o}},B=function(e,t,n,r){var a,i;if(!e||!t)return{active:!1,label:"0",accessibilityLabel:M(0,!1,n,r)};var o,c,s,d,f,g,m,v=(o=e,Object.keys(o.reactions).map((function(e){return{count:o.reactions[e].count,reaction:e,text:o.reactions[e].text}})).sort((function(e,t){return t.count-e.count}))),T=Array.from(new(u())(t).difference(l.$N)),_=T.length>0;_?(c=T[0],s=T[1]):(c=(null===(d=v[0])||void 0===d?void 0:d.count)?null===(f=v[0])||void 0===f?void 0:f.reaction:void 0,s=(null===(g=v[1])||void 0===g?void 0:g.count)?null===(m=v[1])||void 0===m?void 0:m.reaction:void 0);var h=M(e.total,_,n,r,c?null===(a=e.reactions[c])||void 0===a?void 0:a.text:void 0,s?null===(i=e.reactions[s])||void 0===i?void 0:i.text:void 0);return{active:_,label:R(e.total,r),accessibilityLabel:h,primaryReaction:c?l.bq[c]:void 0,secondaryReaction:s?l.bq[s]:void 0}},D=function(e,t,n,r){var a,i;if(!e||!t)return{thumbUpCount:"0",thumbUpId:l.PO.THUMBS_UP,thumbDownId:l.PO.THUMBS_DOWN,thumbUpAriaLabel:E(0,n),thumbDownAriaLabel:O(n),thumbUpTestId:(0,f.O)(l.PO.THUMBS_UP,!1,"button",r),thumbDownTestId:(0,f.O)(l.PO.THUMBS_DOWN,!1,"button",r),thumbUpTitle:I(!1,n),thumbDownTitle:A(!1,n)};var o,c=null!==(i=null===(a=e.reactions[l.PO.THUMBS_UP])||void 0===a?void 0:a.count)&&void 0!==i?i:0,u=R(c,n);return t.includes(l.PO.THUMBS_UP)?o=s.ReactionSelectorThumbState.THUMBS_UP:t.includes(l.PO.THUMBS_DOWN)&&(o=s.ReactionSelectorThumbState.THUMBS_DOWN),{thumbUpCount:u,userThumbState:o,thumbUpId:l.PO.THUMBS_UP,thumbDownId:l.PO.THUMBS_DOWN,thumbUpAriaLabel:E(c,n),thumbDownAriaLabel:O(n),thumbUpTestId:(0,f.O)(l.PO.THUMBS_UP,o===s.ReactionSelectorThumbState.THUMBS_UP,"button",r),thumbDownTestId:(0,f.O)(l.PO.THUMBS_DOWN,o===s.ReactionSelectorThumbState.THUMBS_DOWN,"button",r),thumbUpTitle:I(o===s.ReactionSelectorThumbState.THUMBS_UP,n),thumbDownTitle:A(o===s.ReactionSelectorThumbState.THUMBS_DOWN,n)}},H=function(e,t,n,r){if(!e||!t)return[];var a=[];return Object.entries(e.reactions).forEach((function(e){var i=(0,o.Z)(e,2),c=i[0],u=i[1],s=t.includes(c),d={name:l.bq[c],label:u.text},g=C(d.label||"",u.count,n),m=C(d.label||"",0,n),v=function(e,t,n){return n.formatMessage({id:"feature_reactions_selector_reaction_title",defaultMessage:"{active, select, true {Select to remove reaction {reactionName}} other {Select to react {reactionName}}}"},{active:e,reactionName:t})}(s,d.label||"",n);a.push({reaction:d,reactionId:c,hasUserReacted:s,reactionAriaLabel:g,reactionAriaDescriptor:m,reactionCount:R(u.count,n),reactionChipTestId:(0,f.O)(c,s,"chip",r),reactionButtonTestId:(0,f.O)(c,s,"button",r),reactionTitle:v})})),a},P=function(e){return null===e||void 0===e?void 0:e.reduce((function(e,t){return(0,i.Z)((0,a.Z)({},e),(0,r.Z)({},t.reaction.reactionId,t))}),{})},L=function(e){return null===e||void 0===e?void 0:e.reduce((function(e,t){return(0,i.Z)((0,a.Z)({},e),(0,r.Z)({},t.groupId,{totalCount:t.aggregateCount,summary:t.reactionSummaries.reduce((function(e,t){return(0,i.Z)((0,a.Z)({},e),(0,r.Z)({},t.reaction.reactionId,{count:t.count,text:t.reaction.text}))}),{})}))}),{})},Z=function(e){return!e||e===d.e.ERROR},w=function(e){return!e}},87993:function(e,t,n){n.d(t,{F:function(){return i},O:function(){return a}});var r=n(85285),a=function(e,t,n,a){return"".concat(r.z7.REACTION_SELECTOR,"-").concat(a,"-").concat(r.cC[e],"-").concat(n,"-").concat(t?r.G5.ACTIVE:r.G5.INACTIVE)},i=function(e){return"".concat(r.z7.REACTION_SELECTOR,"-").concat(e,"-").concat(r.G5.MENU,"-").concat(r.G5.BUTTON)}},42886:function(e,t,n){n.d(t,{Z:function(){return H}});var r=n(2784),a=n(14865),i=n(947),o=n.n(i),c=n(26806),u=n(94177),s=n(25140),l=n(66655),d=n(35355),f=n(2366),g=n(98621),m=n(15316),v=n(72471),T=n(11869),_=n(19471),h="video",U=n(92228),b=n(16630),p=n.n(b),S=n(30382),R=n.n(S);function E(){var e=(0,U.Z)(["\n    fragment SharedVideoUserReactions on Video {\n        id\n        userReactions {\n            entityId\n            lastUpdated\n            reaction {\n                language {\n                    id\n                    text\n                }\n                reactionId\n                text\n                id\n            }\n        }\n    }\n"]);return E=function(){return e},e}function I(){var e=(0,U.Z)(["\n    fragment SharedVideoReactions on Video {\n        id\n        reactionsSummary {\n            reactionSummaryGroups {\n                aggregateCount\n                displayCount {\n                    value\n                    language\n                }\n                groupId\n                reactionSummaries {\n                    reaction {\n                        language {\n                            id\n                            text\n                        }\n                        reactionId\n                        text\n                        id\n                    }\n                    count\n                    displayCount {\n                        value\n                        language\n                    }\n                }\n                selectionType\n            }\n        }\n    }\n"]);return I=function(){return e},e}function O(){var e=(0,U.Z)(["\n    query ReactionsForVideo(\n        $aggregateVideoConsts: [ID!]!\n        $userVideoConsts: [ID!]!\n    ) {\n        aggregateVideos: videos(ids: $aggregateVideoConsts) {\n            ...SharedVideoReactions\n        }\n\n        userVideos: videos(ids: $userVideoConsts) {\n            ...SharedVideoUserReactions\n        }\n    }\n    ","\n    ","\n"]);return O=function(){return e},e}var A=R()(E()),C=R()(I()),N={query:R()(O(),A,C),createQueryVariablesMap:function(e){var t=[],n=[];return e.forEach((function(e,r){e.needAggregate&&t.push(r),e.needUser&&n.push(r)})),{aggregateVideoConsts:t,userVideoConsts:n}},parseResponseDataToState:function(e,t,n,r,a){if(t.aggregateVideoConsts.length){var i,o=new(p())(t.aggregateVideoConsts),c={};null===e||void 0===e||null===(i=e.aggregateVideos)||void 0===i||i.forEach((function(e){var t;e&&(c[e.id]=(0,_.pp)(null===(t=e.reactionsSummary)||void 0===t?void 0:t.reactionSummaryGroups)||{},o.delete(e.id))})),r.setBulkAggregateReactions(c),o.size&&r.setFetchedStatus(Array.from(o),v.e.ERROR)}if(t.userVideoConsts.length){var u,s=new(p())(t.userVideoConsts),l={};null===e||void 0===e||null===(u=e.userVideos)||void 0===u||u.forEach((function(e){e&&(l[e.id]=(0,_.Nc)(null===e||void 0===e?void 0:e.userReactions)||{},s.delete(e.id))})),a.initializeBulkUserReactions(l),s.size&&a.setFetchedStatus(Array.from(s),v.e.ERROR)}}},M=(0,u.nN)(),y=M.source,B=M.next;a.isBrowser&&(0,u.zG)(y,(0,u.f3)((0,u.FG)(100)),(0,u.qn)(50),(0,u.Ld)((function(e){var t=e[0],n=t.client,r=t.context,a=t.aggregateStoreHandlers,i=t.userStoreHandlers,c=e.reduce((function(e,t){return t.requestInfo.forEach((function(n,r){var a,i=n.entityType;if(e.has(i)||e.set(i,{reactionRequests:new Map,batchInfo:t.batchInfo}),null===(a=e.get(i))||void 0===a?void 0:a.reactionRequests.has(r)){var o,c,u,s,l=null!==(s=null===(o=e.get(i))||void 0===o||null===(c=o.reactionRequests)||void 0===c?void 0:c.get(r))&&void 0!==s?s:{needUser:!0,needAggregate:!0};null===(u=e.get(i))||void 0===u||u.reactionRequests.set(r,{entityType:i,needUser:l.needUser&&n.needUser,needAggregate:l.needAggregate&&n.needAggregate})}else{var d;null===(d=e.get(i))||void 0===d||d.reactionRequests.set(r,n)}})),e}),new Map),u=[],s=[];c.forEach((function(e){s.push(e.batchInfo.parseResponseDataToState),u.push({query:e.batchInfo.query,variables:e.batchInfo.createQueryVariablesMap(e.reactionRequests)})}));var l=o()("BatchedReactions").add(u[0].query,u[0].variables);u.slice(1).reduce((function(e,t){return e.add(t.query,t.variables)}),l),n.query(l.document,l.variables,r).toPromise().then((function(e){s.forEach((function(t){return t(e.data,l.variables||{},e.error,a,i)}))}))})));var D=function(e,t){var n=(0,s.B)().context,a=(0,c.m8)(),i=function(e){if(e===h)return N;throw new Error("Reactions attempting to be batched for an unexpected entity")}(t),o=(0,r.useMemo)((function(){return(0,l.Z)({serverSideCacheable:!1,personalized:!0},n)}),[n]),u=(0,m.l)(),U=(0,T.og)(),b=function(e,t){var n=(0,d.nu)(),r=(0,g.hg)({weblabID:f.lh.IMDB_REACTIONS_ON_VIDEO_831329,treatments:{T1:!0}}),a=(0,m.l)().setFetchedStatus,i=(0,T.og)().setFetchedStatus,o=(0,m.B8)(),c=(0,T.Di)();return e.forEach((function(u,s){u.needAggregate=u.needAggregate&&r&&(0,_.pY)(o.current[s]),u.needUser=u.needUser&&r&&n&&(0,_.pY)(c.current[s]),(!u.needUser&&!u.needAggregate||u.entityType!==t)&&e.delete(s),u.needAggregate&&a(s,v.e.FETCHING),u.needUser&&i(s,v.e.FETCHING)})),e}(e,t);b.size&&B({client:a,context:o,batchInfo:i,aggregateStoreHandlers:u,userStoreHandlers:U,requestInfo:b})},H=function(e){var t=e.associatedConstId,n=e.entityType,a=e.initialAggregateData,i=e.initialUserData,o=(0,T.og)().initializeUserReactions,c=(0,m.l)().setAggregateReactions,u=(0,T.KY)(t),s=!(0,_.uF)(u)||!!i;r.useEffect((function(){(0,_.uF)(u)&&i&&o(t,i)}),[i]);var l=(0,m.if)(t),d=!(0,_.uF)(l)||!!a;r.useEffect((function(){(0,_.uF)(l)&&a&&c(t,a)}),[a]),D(new Map([[t,{needUser:!s,needAggregate:!d,entityType:n}]]),n)}}}]);